@page
@model abakes2.Pages.ManageQRModel

@{
    Layout = null;
}

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i&display=swap" rel="stylesheet">
    <link href="~/css/AdminDashboard/styles.css" rel="stylesheet" asp-append-version="true">
    <script src="https://kit.fontawesome.com/e91d01519e.js" crossorigin="anonymous"></script>

    <title>Manage Codes</title>
</head>

<body>
    <!--NAV BAR-->
    <!-- Banner -->
    <div class="container">
        <div class="topbar">
            <div class="logo">
                <a href="/AdminDashboard"><img src="~/img/logo/logofooter.png" alt="logo" width="75px"></a>
            </div>

            <div class="user">
                <img src="~/img/AdminDashboard/user.png" alt="">
            </div>
        </div>
        <div class="sidebar">
            <ul>
                <li>
                    <a href="/Admin_ManageCakes">
                        <i class="fas fa-birthday-cake"></i>
                        <div>Manage Cake</div>
                    </a>
                </li>
                <li>
                    <a href="/Admin_Manage3DAsset">
                        <i class="fa-brands fa-unity"></i>
                        <div>Manage 3D Asset</div>
                    </a>
                </li>
                <li>
                    <a href="/Admin_ManageOrders">
                        <i class="fas fa-receipt"></i>
                        <div>Manage Orders</div>
                    </a>
                </li>
                <li>
                    <a href="/ManagePayments">
                        <i class="fas fa-money-check"></i>
                        <div>Manage Payments</div>
                    </a>
                </li>
                <li>
                    <a href="/Admin_ManageFeedback">
                        <i class="fas fa-comments"></i>
                        <div>Manage Feedback</div>
                    </a>
                </li>
                <li>
                    <a href="/Admin_Notif">
                        <i class="fas fa-bell"></i>
                        <div>Manage Notification</div>
                    </a>
                </li>
                <li>
                    <a href="/Admin_ManageQR" class="active">
                        <i class="fas fa-qrcode"></i>
                        <div>Manage QR Code</div>
                    </a>
                </li>
                <li>
                    <a href="/Admin_ManageAcc">
                        <i class="fas fa-user"></i>
                        <div>Account Manager</div>
                    </a>
                </li>
                <li>
                    <a href="/AdminDashboard">
                        <i class="fas fa-chart-bar"></i>
                        <div>Statistical Report</div>
                    </a>
                </li>
                <li>
                    <a href="/Admin_ChangePassword">
                        <i class="fas fa-lock"></i>
                        <div>Change Password</div>
                    </a>
                </li>
                <li>
                    <a asp-page="/index" asp-page-handler="LogOut">
                        <i class="fas fa-sign-out-alt"></i>
                        <div>Log out</div>
                    </a>
                </li>
            </ul>
        </div>
        <!-- Banner End -->
        <!--Main Window-->
        <div class="main">
            <!--Title Bar-->
            <section class="page-heading" style="background-image: url('/img/contact/cover2.png');">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="text-content">
                                <h2>Manage Codes</h2>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!--Title Bar End-->

            <div class="admin-table">
                <button type="submit" class="btn" style="margin:1%;">Search</button>
                <form method="post" asp-page-handler="Generate">
                    <input type="number" placeholder="Enter Discount" name="DiscountCoupon" max="100" required> 
                     <button type="submit" class="btn" style="margin:1%;">Generate</button>
                </form>

               
                <div class="search">
                    <label for="search"><i class="fas fa-search"></i></label>
                    <input type="text" name="search" placeholder="Search for Codes">
                </div>
                <table class="table" style="margin:1%;">
                    <thead>
                        <tr>
                            <th style="color:rgb(159, 167, 189); font-family:Poppins;width:5%;">ID</th>
                            <th style="color:rgb(159, 167, 189); font-family:Poppins;width:5%;">Generated Code</th>
                            <th style="color:rgb(159, 167, 189); font-family:Poppins;width:5%;">Status</th>
                            <th style="color:rgb(159, 167, 189); font-family:Poppins;width:25%;">Expiration Date</th>
                            <th style="color:rgb(159, 167, 189); font-family:Poppins;width:25%;">Discount</th>
                            <th style="color:rgb(159, 167, 189); font-family:Poppins;width:45%;">QR Code</th>
                            <th style="color:rgb(159, 167, 189); font-family:Poppins;width:15%;">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.codeList)
                        {
                            <tr>
                                <td><p>@item.id</p></td>
                                <td><p>@item.generatedCode</p></td>
                                <td><p>@item.status</p></td>
                                <td><p>@item.dateexpiry</p></td>
                                <td><p>@item.discount%</p></td>

                                <td>
                                    @if (item.status.Equals("true"))
                                    {

                                    }
                                    else
                                    {
                                        <a class='btn btn-btn-dark btn-sm' disabled style="color:rgb(173, 136, 125); font-family:Poppins ExtraBold; background-color: #fbc1b4;"> Deactivate </a>
                                    }
                                </td>


                                <td>
                                    <a class='btn btn-btn-dark btn-sm' asp-page-handler="Deactivate" asp-route-id="@item.id" style="background: #9a0009; padding:15px 13px;" asp-page-handler="Remove" asp-route-id=@item.id>
                                        <i class="fas fa-ban" style="font-size:30px;"></i> <div>Deactivate</div>
                                    </a>
                                    <a class='btn btn-btn-dark btn-sm' href="/card?maincode=@item.generatedCode" style="background:#FFCA6D; color:black; padding:15px 30px;">
                                        <i class="fas fa-qrcode" style="font-size:30px;"></i><div>View</div>
                                    </a>
                                </td>
                            </tr>
                        }

                    </tbody>
                </table>
            </div>

            <!--Main Window End-->
            <!-- javascript -->

            <script>
                var MenuItems = document.getElementById("MenuItems");
                MenuItems.style.maxHeight = "0px";
                function menutoggle() {
                    if (MenuItems.style.maxHeight == "0px") {
                        MenuItems.style.maxHeight = "300px"
                    }
                    else {
                        MenuItems.style.maxHeight = "0px"
                    }
                }
            </script>

            <!-- Toggle Form -->
            <script>
                var LoginForm = document.getElementById("LoginForm");
                var RegForm = document.getElementById("RegForm");
                var Indicator = document.getElementById("Indicator");
                function register() {
                    RegForm.style.transform = "translatex(0px)";
                    LoginForm.style.transform = "translatex(0px)";
                    Indicator.style.transform = "translateX(100px)";

                }
                function login() {
                    RegForm.style.transform = "translatex(300px)";
                    LoginForm.style.transform = "translatex(300px)";
                    Indicator.style.transform = "translate(0px)";

                }
            </script>
            <script>
                setInterval(function () {
                    $.ajax({
                        url: "/managecode?handler=Expiration",
                        type: "GET",
                        success: function (result) {
                            console.log(result);
                            // handle the response here
                        },
                        error: function (xhr, status, error) {
                            console.log("Error: " + error);
                        }
                    });
                }, 1000);
            </script>
</body>